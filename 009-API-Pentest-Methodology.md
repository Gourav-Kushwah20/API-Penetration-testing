# ğŸš€ API Pentest Methodology

## ğŸ” API Penetration Testing Methodology

A structured methodology ensures complete coverage of authentication, authorization, data handling, and business logic vulnerabilities in APIs.

This guide aligns with the **OWASP API Security Top 10** and modern API attack techniques.

---

## ğŸ” 1. Reconnaissance & Discovery

### ğŸŒ 1.1 Identify Base URL

- `https://api.target.com`
- `https://target.com/api`

**ğŸ” Check versions:**
- `/v1/`
- `/v2/`
- `/beta/`

---

### ğŸ“„ 1.2 Discover Documentation

- `/swagger`
- `/swagger-ui`
- `/v3/api-docs`
- `/openapi.json`
- `/docs`

**ğŸ§  Check for:**
- Public OpenAPI specs  
- GraphQL endpoints (`/graphql`)  
- Postman collections  

---

### ğŸ“¡ 1.3 Traffic Analysis

**ğŸ›  Use tools like:**
- Burp Suite  
- OWASP ZAP  

**ğŸ” Analyze:**
- Request headers  
- Tokens  
- Hidden endpoints  
- API calls from frontend JS  

---

## ğŸ”‘ 2. Authentication Analysis

Identify how the API authenticates users.

### ğŸ” 2.1 Common Authentication Mechanisms

- Session Cookies  
- Bearer Tokens  
- JWT  
- API Keys  
- OAuth 2.0  
- mTLS  

#### ğŸ§¾ If JWT is used:

**ğŸ§© Decode token**

**ğŸ” Check:**
- `alg` field  
- Expiry (`exp`)  
- Role claims  

**ğŸ§ª Test:**
- Algorithm confusion  
- Signature bypass  
- Token tampering  
- None algorithm  

---

## ğŸ›‚ 3. Authorization Testing (Broken Access Control)

One of the most critical API vulnerabilities.

### ğŸ”„ 3.1 BOLA (Broken Object Level Authorization)

**Example:**
```http
GET /api/users/1001
````

**Change:**

```http
GET /api/users/1002
```

âœ… Check if you can access another user's data.

---

### â¬†ï¸ 3.2 Vertical Privilege Escalation

* Access `/admin`
* Modify roles
* Access restricted endpoints

---

### â†”ï¸ 3.3 Horizontal Privilege Escalation

* Access other user resources
* Modify other user profiles

---

## ğŸ—º 4. Endpoint Enumeration

### ğŸ§­ 4.1 Methods

* Analyze JS files
* Review mobile app traffic
* Check API documentation
* Fuzz endpoints
* Use wordlists

**ğŸ” Look for:**

* Hidden admin endpoints
* Debug endpoints
* Backup versions
* Deprecated APIs

---

### ğŸŒ 4.2 HTTP Method Testing

**ğŸ§ª Test all methods:**

* GET
* POST
* PUT
* PATCH
* DELETE
* OPTIONS

**âš ï¸ Check for:**

* Method override headers
* Improperly restricted methods
* CORS misconfiguration

---

## ğŸ§¨ 5. Input Validation Testing

Test all input parameters.

### ğŸ’‰ 5.1 Injection Attacks

* SQL Injection
* NoSQL Injection
* Command Injection
* LDAP Injection
* Template Injection

---

### ğŸ“¦ 5.2 JSON Attacks

* Nested JSON manipulation
* Unexpected properties (Mass Assignment)
* Type confusion
* Large payloads

**Example:**

```json
{
  "username": "user1",
  "role": "admin"
}
```

---

## ğŸ§  6. Business Logic Testing

APIs often fail in logic enforcement.

**ğŸ§ª Test:**

* Price manipulation
* Quantity tampering
* Workflow bypass
* Race conditions
* Replay attacks
* Refund abuse
* Coupon reuse

**Example:**

* Modify price before checkout
* Skip payment verification step

---

## ğŸš¦ 7. Rate Limiting & Brute Force

**ğŸ§ª Test for:**

* Login brute force
* OTP brute force
* Password reset abuse
* Enumeration attacks

**ğŸ” Check:**

* Rate limiting headers
* Lockout mechanisms
* CAPTCHA enforcement

---

## ğŸ“‚ 8. Data Exposure Testing

**ğŸ” Look for:**

* Excessive data exposure
* Debug messages
* Stack traces
* Internal IP addresses
* API keys in responses
* Hidden fields in JSON

**Example:**

```json
{
  "id": 101,
  "email": "user@email.com",
  "passwordHash": "...",
  "internalNotes": "VIP customer"
}
```

---

## âš™ï¸ 9. API Configuration Testing

### ğŸŒ 9.1 CORS Misconfiguration

**ğŸ” Check:**

* `Access-Control-Allow-Origin: *`
* Allow credentials with wildcard

---

### ğŸ›¡ 9.2 Security Headers

* HSTS
* CSP
* X-Content-Type-Options

---

### ğŸ“¡ 9.3 HTTP Response Codes

* Improper status codes
* 200 for failed requests

---

## ğŸ”· 10. GraphQL Testing (If Applicable)

**ğŸ” Check:**

* Introspection enabled
* Query depth abuse
* Query batching
* Field suggestion attacks

**Example:**

```graphql
{
  __schema {
    types {
      name
    }
  }
}
```

---

## ğŸ“¤ 11. File Upload Testing

**ğŸ§ª Test:**

* Extension bypass
* MIME type bypass
* Large file DoS
* Path traversal in filename

---

## ğŸ¤– 12. Automation & Fuzzing

**ğŸ›  Use:**

* ffuf
* Postman
* curl

**ğŸ¯ Fuzz:**

* IDs
* Parameters
* Headers
* JSON keys

---

## ğŸ“Š 13. Logging & Monitoring Weaknesses

**ğŸ§ª Test:**

* Invalid login attempts logged?
* Token misuse detected?
* Admin access alerts?

---

## ğŸ›  14. API Pentest Execution Flow (Practical Workflow)

### 1. Recon & documentation discovery
### 2. Intercept traffic
### 3. Map endpoints
### 4. Identify authentication
### 5. Test authentication flaws
### 6. Test authorization (BOLA/IDOR)
### 7. Test input validation
### 8. Test business logic
### 9. Test rate limiting
### 10. Test misconfigurations
### 11. Validate findings
### 12. Document impact

---

---

## ğŸ“‹ API Pentest Worksheet Template

### ğŸ¯ Target Information

```text
Target URI:
Authentication Type:
API Version:
Role Tested:
```

---

## ğŸ—‚ Endpoint Mapping Table

| Resource | Method | Endpoint | Parameters | Auth Required | Role Required | Notes |
| -------- | ------ | -------- | ---------- | ------------- | ------------- | ----- |
|          |        |          |            |               |               |       |
|          |        |          |            |               |               |       |
|          |        |          |            |               |               |       |

---

## ğŸ Vulnerability Tracking Table

| Vulnerability | Endpoint | Severity | Impact | Status |
| ------------- | -------- | -------- | ------ | ------ |
|               |          |          |        |        |
|               |          |          |        |        |
|               |          |          |        |        |

---

## ğŸ“ Reporting Structure

When reporting:

1. ğŸ“Œ Endpoint
2. ğŸ“¤ Request
3. ğŸ” Modified Request
4. ğŸ“¥ Response
5. ğŸ’¥ Impact
6. ğŸ§ª Proof of Concept
7. ğŸ›  Remediation

---

